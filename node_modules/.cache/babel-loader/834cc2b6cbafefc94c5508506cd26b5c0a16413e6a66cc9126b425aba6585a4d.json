{"ast":null,"code":"import _objectSpread from\"/Users/zahurshaikh/Documents/Refer-Earn-APP/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from\"react\";import{useAuth}from\"../../hooks/useAuth\";import{db}from\"../../firebase/config\";import{collection,query,where,getDocs,orderBy}from\"firebase/firestore\";import{ArrowUpRight,ArrowDownRight,Filter}from\"lucide-react\";import{formatCurrency,formatDate}from\"../../utils/helpers\";import{TRANSACTION_TYPES}from\"../../utils/constants\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TransactionHistory=()=>{const{userData}=useAuth();const[transactions,setTransactions]=useState([]);const[filteredTransactions,setFilteredTransactions]=useState([]);const[filter,setFilter]=useState(\"ALL\");const[loading,setLoading]=useState(true);useEffect(()=>{fetchTransactions();},[userData]);useEffect(()=>{filterTransactions();},[filter,transactions]);const fetchTransactions=async()=>{if(!userData)return;try{const q=query(collection(db,\"transactions\"),where(\"userId\",\"==\",userData.id),orderBy(\"createdAt\",\"desc\"));const snapshot=await getDocs(q);const data=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));setTransactions(data);setFilteredTransactions(data);}catch(error){console.error(\"Error fetching transactions:\",error);}finally{setLoading(false);}};const filterTransactions=()=>{if(filter===\"ALL\"){setFilteredTransactions(transactions);}else{setFilteredTransactions(transactions.filter(t=>t.type===filter));}};const getTransactionIcon=type=>{if(type===TRANSACTION_TYPES.CREDIT||type===TRANSACTION_TYPES.REFERRAL_BONUS){return/*#__PURE__*/_jsx(ArrowDownRight,{className:\"h-5 w-5 text-green-600\"});}else{return/*#__PURE__*/_jsx(ArrowUpRight,{className:\"h-5 w-5 text-red-600\"});}};const getTransactionColor=type=>{if(type===TRANSACTION_TYPES.CREDIT||type===TRANSACTION_TYPES.REFERRAL_BONUS){return\"bg-green-100\";}else{return\"bg-red-100\";}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-96\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600\"})});}return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-4xl mx-auto space-y-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 space-y-4 sm:space-y-0\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900\",children:\"Transaction History\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Filter,{className:\"h-5 w-5 text-gray-500\"}),/*#__PURE__*/_jsxs(\"select\",{value:filter,onChange:e=>setFilter(e.target.value),className:\"input-field w-auto\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"ALL\",children:\"All Transactions\"}),/*#__PURE__*/_jsx(\"option\",{value:TRANSACTION_TYPES.CREDIT,children:\"Credits\"}),/*#__PURE__*/_jsx(\"option\",{value:TRANSACTION_TYPES.DEBIT,children:\"Debits\"}),/*#__PURE__*/_jsx(\"option\",{value:TRANSACTION_TYPES.REFERRAL_BONUS,children:\"Referral Bonus\"}),/*#__PURE__*/_jsx(\"option\",{value:TRANSACTION_TYPES.WITHDRAWAL,children:\"Withdrawals\"})]})]})]}),filteredTransactions.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-12\",children:\"No transactions found\"}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:filteredTransactions.map(txn=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:shadow-md transition\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-lg \".concat(getTransactionColor(txn.type)),children:getTransactionIcon(txn.type)}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-900\",children:txn.description}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:formatDate(txn.createdAt)}),/*#__PURE__*/_jsx(\"span\",{className:\"inline-block mt-1 px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded\",children:txn.type})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-xl font-bold \".concat(txn.type===TRANSACTION_TYPES.CREDIT||txn.type===TRANSACTION_TYPES.REFERRAL_BONUS?\"text-green-600\":\"text-red-600\"),children:[txn.type===TRANSACTION_TYPES.CREDIT||txn.type===TRANSACTION_TYPES.REFERRAL_BONUS?\"+\":\"-\",formatCurrency(txn.amount)]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:txn.status})]})]},txn.id))})]})});};export default TransactionHistory;","map":{"version":3,"names":["React","useState","useEffect","useAuth","db","collection","query","where","getDocs","orderBy","ArrowUpRight","ArrowDownRight","Filter","formatCurrency","formatDate","TRANSACTION_TYPES","jsx","_jsx","jsxs","_jsxs","TransactionHistory","userData","transactions","setTransactions","filteredTransactions","setFilteredTransactions","filter","setFilter","loading","setLoading","fetchTransactions","filterTransactions","q","id","snapshot","data","docs","map","doc","_objectSpread","error","console","t","type","getTransactionIcon","CREDIT","REFERRAL_BONUS","className","getTransactionColor","children","value","onChange","e","target","DEBIT","WITHDRAWAL","length","txn","concat","description","createdAt","amount","status"],"sources":["/Users/zahurshaikh/Documents/Refer-Earn-APP/src/components/user/TransactionHistory.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useAuth } from \"../../hooks/useAuth\";\nimport { db } from \"../../firebase/config\";\nimport { collection, query, where, getDocs, orderBy } from \"firebase/firestore\";\nimport { ArrowUpRight, ArrowDownRight, Filter } from \"lucide-react\";\nimport { formatCurrency, formatDate } from \"../../utils/helpers\";\nimport { TRANSACTION_TYPES } from \"../../utils/constants\";\n\nconst TransactionHistory = () => {\n  const { userData } = useAuth();\n  const [transactions, setTransactions] = useState([]);\n  const [filteredTransactions, setFilteredTransactions] = useState([]);\n  const [filter, setFilter] = useState(\"ALL\");\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetchTransactions();\n  }, [userData]);\n\n  useEffect(() => {\n    filterTransactions();\n  }, [filter, transactions]);\n\n  const fetchTransactions = async () => {\n    if (!userData) return;\n\n    try {\n      const q = query(\n        collection(db, \"transactions\"),\n        where(\"userId\", \"==\", userData.id),\n        orderBy(\"createdAt\", \"desc\")\n      );\n      const snapshot = await getDocs(q);\n      const data = snapshot.docs.map((doc) => ({\n        id: doc.id,\n        ...doc.data(),\n      }));\n      setTransactions(data);\n      setFilteredTransactions(data);\n    } catch (error) {\n      console.error(\"Error fetching transactions:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const filterTransactions = () => {\n    if (filter === \"ALL\") {\n      setFilteredTransactions(transactions);\n    } else {\n      setFilteredTransactions(transactions.filter((t) => t.type === filter));\n    }\n  };\n\n  const getTransactionIcon = (type) => {\n    if (\n      type === TRANSACTION_TYPES.CREDIT ||\n      type === TRANSACTION_TYPES.REFERRAL_BONUS\n    ) {\n      return <ArrowDownRight className=\"h-5 w-5 text-green-600\" />;\n    } else {\n      return <ArrowUpRight className=\"h-5 w-5 text-red-600\" />;\n    }\n  };\n\n  const getTransactionColor = (type) => {\n    if (\n      type === TRANSACTION_TYPES.CREDIT ||\n      type === TRANSACTION_TYPES.REFERRAL_BONUS\n    ) {\n      return \"bg-green-100\";\n    } else {\n      return \"bg-red-100\";\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-96\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-4xl mx-auto space-y-6\">\n      <div className=\"card\">\n        <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 space-y-4 sm:space-y-0\">\n          <h2 className=\"text-2xl font-bold text-gray-900\">\n            Transaction History\n          </h2>\n\n          {/* Filter */}\n          <div className=\"flex items-center space-x-2\">\n            <Filter className=\"h-5 w-5 text-gray-500\" />\n            <select\n              value={filter}\n              onChange={(e) => setFilter(e.target.value)}\n              className=\"input-field w-auto\"\n            >\n              <option value=\"ALL\">All Transactions</option>\n              <option value={TRANSACTION_TYPES.CREDIT}>Credits</option>\n              <option value={TRANSACTION_TYPES.DEBIT}>Debits</option>\n              <option value={TRANSACTION_TYPES.REFERRAL_BONUS}>\n                Referral Bonus\n              </option>\n              <option value={TRANSACTION_TYPES.WITHDRAWAL}>Withdrawals</option>\n            </select>\n          </div>\n        </div>\n\n        {/* Transaction List */}\n        {filteredTransactions.length === 0 ? (\n          <p className=\"text-gray-500 text-center py-12\">\n            No transactions found\n          </p>\n        ) : (\n          <div className=\"space-y-3\">\n            {filteredTransactions.map((txn) => (\n              <div\n                key={txn.id}\n                className=\"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:shadow-md transition\"\n              >\n                <div className=\"flex items-center space-x-4\">\n                  <div\n                    className={`p-3 rounded-lg ${getTransactionColor(\n                      txn.type\n                    )}`}\n                  >\n                    {getTransactionIcon(txn.type)}\n                  </div>\n                  <div>\n                    <p className=\"font-semibold text-gray-900\">\n                      {txn.description}\n                    </p>\n                    <p className=\"text-sm text-gray-500\">\n                      {formatDate(txn.createdAt)}\n                    </p>\n                    <span className=\"inline-block mt-1 px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded\">\n                      {txn.type}\n                    </span>\n                  </div>\n                </div>\n                <div className=\"text-right\">\n                  <p\n                    className={`text-xl font-bold ${\n                      txn.type === TRANSACTION_TYPES.CREDIT ||\n                      txn.type === TRANSACTION_TYPES.REFERRAL_BONUS\n                        ? \"text-green-600\"\n                        : \"text-red-600\"\n                    }`}\n                  >\n                    {txn.type === TRANSACTION_TYPES.CREDIT ||\n                    txn.type === TRANSACTION_TYPES.REFERRAL_BONUS\n                      ? \"+\"\n                      : \"-\"}\n                    {formatCurrency(txn.amount)}\n                  </p>\n                  <p className=\"text-xs text-gray-500 mt-1\">{txn.status}</p>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default TransactionHistory;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}