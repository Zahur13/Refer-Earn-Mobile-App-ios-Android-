{"ast":null,"code":"import _objectSpread from\"/Users/zahurshaikh/Documents/Refer-Earn-APP/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState,useEffect,createContext,useContext}from\"react\";import{auth,db}from\"../firebase/config\";import{onAuthStateChanged,signOut as firebaseSignOut}from\"firebase/auth\";import{doc,getDoc}from\"firebase/firestore\";import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[userData,setUserData]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{const unsubscribe=onAuthStateChanged(auth,async firebaseUser=>{if(firebaseUser){setUser(firebaseUser);// Fetch user data from Firestore\nconst userDoc=await getDoc(doc(db,\"users\",firebaseUser.uid));if(userDoc.exists()){setUserData(_objectSpread({id:userDoc.id},userDoc.data()));}}else{setUser(null);setUserData(null);}setLoading(false);});return unsubscribe;},[]);const signOut=async()=>{await firebaseSignOut(auth);setUser(null);setUserData(null);};const refreshUserData=async()=>{if(user){const userDoc=await getDoc(doc(db,\"users\",user.uid));if(userDoc.exists()){setUserData(_objectSpread({id:userDoc.id},userDoc.data()));}}};const value={user,userData,loading,signOut,refreshUserData,isAdmin:(userData===null||userData===void 0?void 0:userData.role)===\"admin\"};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});};export const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error(\"useAuth must be used within AuthProvider\");}return context;};","map":{"version":3,"names":["useState","useEffect","createContext","useContext","auth","db","onAuthStateChanged","signOut","firebaseSignOut","doc","getDoc","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","userData","setUserData","loading","setLoading","unsubscribe","firebaseUser","userDoc","uid","exists","_objectSpread","id","data","refreshUserData","value","isAdmin","role","Provider","useAuth","context","Error"],"sources":["/Users/zahurshaikh/Documents/Refer-Earn-APP/src/hooks/useAuth.js"],"sourcesContent":["import { useState, useEffect, createContext, useContext } from \"react\";\nimport { auth, db } from \"../firebase/config\";\nimport { onAuthStateChanged, signOut as firebaseSignOut } from \"firebase/auth\";\nimport { doc, getDoc } from \"firebase/firestore\";\n\nconst AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [userData, setUserData] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (firebaseUser) => {\n      if (firebaseUser) {\n        setUser(firebaseUser);\n        // Fetch user data from Firestore\n        const userDoc = await getDoc(doc(db, \"users\", firebaseUser.uid));\n        if (userDoc.exists()) {\n          setUserData({ id: userDoc.id, ...userDoc.data() });\n        }\n      } else {\n        setUser(null);\n        setUserData(null);\n      }\n      setLoading(false);\n    });\n\n    return unsubscribe;\n  }, []);\n\n  const signOut = async () => {\n    await firebaseSignOut(auth);\n    setUser(null);\n    setUserData(null);\n  };\n\n  const refreshUserData = async () => {\n    if (user) {\n      const userDoc = await getDoc(doc(db, \"users\", user.uid));\n      if (userDoc.exists()) {\n        setUserData({ id: userDoc.id, ...userDoc.data() });\n      }\n    }\n  };\n\n  const value = {\n    user,\n    userData,\n    loading,\n    signOut,\n    refreshUserData,\n    isAdmin: userData?.role === \"admin\",\n  };\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n};\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error(\"useAuth must be used within AuthProvider\");\n  }\n  return context;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}